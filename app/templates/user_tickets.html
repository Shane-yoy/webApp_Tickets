{% extends "base_user.html" %}
{% block title %}ğŸŸï¸ Mes tickets{% endblock %}

{% block content %}
<div class="user-tickets-container">
  <h1 class="page-title">ğŸ« CrÃ©er un nouveau ticket</h1>

  <!-- ğŸ“ Formulaire de crÃ©ation -->
  <form method="POST" class="user-ticket-form">
    <label for="subject">Sujet :</label>
    <input type="text" id="subject" name="subject" placeholder="Sujet du ticket" required>

    <label for="content">Message initial :</label>
    <textarea id="content" name="content" rows="4" placeholder="DÃ©cris ton problÃ¨me..." required></textarea>

    <button type="submit" class="btn-user-submit">Envoyer</button>
  </form>

  <!-- ğŸ“‹ Liste des tickets crÃ©Ã©s -->
<h2 class="sub-title">ğŸ“‹ Mes tickets</h2>

{% if tickets %}
  <table class="user-tickets-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Sujet</th>
        <th>Statut</th>
        <th>Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for ticket in tickets %}
      <tr>
        <td data-label="ID">{{ ticket.id }}</td>
        <td data-label="Sujet">{{ ticket.subject }}</td>
        <td data-label="Statut">
          {% if ticket.status == 'open' %}
            ğŸŸ¢ Ouvert
          {% elif ticket.status == 'pending' %}
            ğŸŸ¡ En attente
          {% else %}
            ğŸ”´ FermÃ©
          {% endif %}
        </td>
        <td data-label="Date">{{ ticket.created_at.strftime('%d/%m/%Y') }}</td>
        <td data-label="Actions">
          <a href="{{ url_for('user_chat.view_user_chat', ticket_id=ticket.id) }}" class="btn-user-view">ğŸ’¬ Voir</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>ğŸ“­ Aucun ticket crÃ©Ã© pour l'instant. Tu peux en crÃ©er un !</p>
{% endif %}

</div>
{% endblock %}
